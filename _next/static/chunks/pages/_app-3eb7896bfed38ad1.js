(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6840:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return e(3893)}])},9079:function(t,n,e){"use strict";e.d(n,{H:function(){return d},a:function(){return f}});var a=e(5893),o=e(7294),c=e(4279);let i=async t=>{let n=await fetch("".concat(c.T5,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),e=await (0,c._y)(n);return(0,c.uB)(e.token),e},r=async t=>{let n=await fetch("".concat(c.T5,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),e=await (0,c._y)(n);return(0,c.uB)(e.token),e},u=async()=>{let t=(0,c.bW)();if(!t)throw Object.assign(Error("Not authenticated"),{status:401});let n=await fetch("".concat(c.T5,"/api/auth/me"),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)}});return(0,c._y)(n)},s=()=>{(0,c.Rn)()},l=(0,o.createContext)(void 0),d=t=>{let{children:n}=t,[e,d]=(0,o.useState)(null),[f,h]=(0,o.useState)(null),[p,w]=(0,o.useState)(!0),y=(0,o.useCallback)(async()=>{let t=(0,c.bW)();if(!t){w(!1);return}h(t);try{let t=await u();d(t)}catch(t){s(),d(null),h(null)}finally{w(!1)}},[]);(0,o.useEffect)(()=>{y()},[y]);let m=(0,o.useCallback)(async t=>{let{token:n,user:e}=await r(t);(0,c.uB)(n),h(n),d(e)},[]),b=(0,o.useCallback)(async t=>{let{token:n,user:e}=await i(t);(0,c.uB)(n),h(n),d(e)},[]),v=(0,o.useCallback)(()=>{s(),d(null),h(null)},[]),T=(0,o.useCallback)(async()=>{if(!(0,c.bW)()){v();return}try{let t=await u();d(t)}catch(t){v()}},[v]),_=(0,o.useMemo)(()=>({isAuthenticated:!!(e&&f),isLoading:p,user:e,token:f,login:m,register:b,logout:v,refreshProfile:T}),[e,f,p,m,b,v,T]);return(0,a.jsx)(l.Provider,{value:_,children:n})},f=()=>{let t=(0,o.useContext)(l);if(!t)throw Error("useAuth must be used within an AuthProvider");return t}},3893:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return r}});var a=e(5893),o=e(9008),c=e.n(o);e(1784);var i=e(9079);function r(t){let{Component:n,pageProps:e}=t;return(0,a.jsxs)(i.H,{children:[(0,a.jsxs)(c(),{children:[(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("meta",{name:"theme-color",content:"#4f46e5"}),(0,a.jsx)("link",{rel:"manifest",href:"/frontend_todo/manifest.json"}),(0,a.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/frontend_todo/apple-touch-icon.png"})]}),(0,a.jsx)(n,{...e})]})}},4279:function(t,n,e){"use strict";e.d(n,{CU:function(){return w},Dp:function(){return y},JV:function(){return p},Os:function(){return b},Rn:function(){return l},T5:function(){return a},_y:function(){return f},aS:function(){return m},bW:function(){return u},dn:function(){return v},uB:function(){return s},zB:function(){return h}});let a="https://backend-todo-9uo7.onrender.com",o="todo_auth_token",c={Accept:"application/json"},i=null,r=()=>{if(i)return i;let t=window.localStorage.getItem(o);return i=t,t},u=()=>r(),s=t=>{i=t,t?window.localStorage.setItem(o,t):window.localStorage.removeItem(o)},l=()=>{s(null)},d=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r();return n?{...t,Authorization:"Bearer ".concat(n)}:t};async function f(t){var n;let e=null;try{e=await t.json()}catch(t){}if(!t.ok||(null==e?void 0:e.success)===!1){let n=Error((null==e?void 0:e.message)||t.statusText||"Request failed");throw n.status=t.status,401===t.status&&l(),n}return null!==(n=null==e?void 0:e.data)&&void 0!==n?n:e}async function h(){return f(await fetch("".concat(a,"/api/todos"),{method:"GET",headers:d(c)}))}async function p(t){return f(await fetch("".concat(a,"/api/todos"),{method:"POST",body:t,headers:d()}))}async function w(t,n){return f(await fetch("".concat(a,"/api/todos/").concat(t),{method:"PATCH",headers:d({...c,"Content-Type":"application/json"}),body:JSON.stringify(n)}))}async function y(t,n){return f(await fetch("".concat(a,"/api/todos/").concat(t),{method:"PATCH",headers:d(),body:n}))}async function m(t){let n=await fetch("".concat(a,"/api/todos/").concat(t),{method:"DELETE",headers:d(c)});await f(n)}async function b(t,n){return f(await fetch("".concat(a,"/api/todos/").concat(t,"/status"),{method:"PATCH",headers:d({...c,"Content-Type":"application/json"}),body:JSON.stringify({status:n})}))}async function v(t){var n;let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o={method:"PATCH",headers:d({...c,"Content-Type":"application/json"}),body:JSON.stringify({updates:t}),keepalive:null!==(n=e.keepalive)&&void 0!==n&&n};try{let t=await fetch("".concat(a,"/api/todos/batch-update"),o);await f(t);return}catch(t){if((null==t?void 0:t.status)!==404)throw t}let i=await fetch("".concat(a,"/api/todos/status/batch"),{...o,method:"POST"});await f(i)}},1784:function(){},9008:function(t,n,e){t.exports=e(7828)}},function(t){var n=function(n){return t(t.s=n)};t.O(0,[774,179],function(){return n(6840),n(9090)}),_N_E=t.O()}]);